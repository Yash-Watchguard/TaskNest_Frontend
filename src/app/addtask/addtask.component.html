<p-toast position="top-right"></p-toast>
<div class="modal-overlay">
  <div class="modal-content">
    <header class="modal-header">
      <div class="modal-title-container">
        <i class="plus-icon">+</i>
        <h2>Create New Project</h2>
      </div>
      <p class="modal-subtitle">Fill in the details to create a new project</p>
    </header>

    <div class="modal-scroll-area">
      <form class="form" #addtask="ngForm">
        <div class="form-group">
          <label for="task-titel" class="form-label">Titel</label>
          <input
            type="text"
            class="form-input"
            id="task-titel"
            placeholder="Enter task titel"
            required
            [(ngModel)]="titel"
            name="titel"
            #projectNameInput="ngModel"
          />
          @if (projectNameInput.touched && projectNameInput.invalid) {
          <p class="validation-error">Task titel cannot be empty</p>
          }
        </div>

        <div class="form-group">
          <label for="description" class="form-label">Task Description</label>
          <textarea
            class="form-input"
            id="description"
            placeholder="Enter task description"
            rows="3"
            maxlength="500"
            required
            [(ngModel)]="destcription"
            name="project_description"
            #descriptionInput="ngModel"
          ></textarea>
          @if (descriptionInput.touched && descriptionInput.invalid && descriptionInput.dirty) {
          <p class="validation-error">Task description cannot be empty</p>
          }
        </div>

        <div class="form-group">
          <label for="acceptance" class="form-label">Acceptance Criteria</label>
          <textarea
            class="form-input"
            id="acceptance"
            placeholder="Enter acceptance criteria"
            rows="3"
            maxlength="500"
            required
            [(ngModel)]="acceptance_criteria"
            name="acceptance_criteria"
            #acceptanceInput="ngModel"
          ></textarea>
          @if (acceptanceInput.touched && acceptanceInput.invalid) {
          <p class="validation-error">Acceptance criteria cannot be empty</p>
          }
        </div>

        <div class="form-group">
          <label for="priority" class="form-label">Select priority</label>
          <select
            class="form-input"
            [(ngModel)]="priority"
            required
            name="priority"
            #priorityInput="ngModel"
          >
            <option value="" disabled selected>Select priority</option>
            <option value="High">High</option>
            <option value="Medium">Medium</option>
            <option value="Low">Low</option>
          </select>
          @if (priorityInput.touched && priorityInput.invalid) {
          <p class="validation-error">Please select a priority</p>
          }
        </div>

        <div class="form-group">
          <label for="deadline" class="form-label">Task Deadline</label>
          <input
            type="date"
            class="form-input"
            id="deadline"
            min="2025-10-09"
            required
            (keydown)="onKeyDown($event)"
            (paste)="$event.preventDefault()"
            [(ngModel)]="date"
            name="deadline"
            #deadlineInput="ngModel"
          />
          @if (deadlineInput.touched && deadlineInput.invalid) {
          <p class="validation-error">Deadline cannot be empty</p>
          }
        </div>

        <div class="form-group">
          <label for="manager-id" class="form-label">Assign Employee</label>
          <select
            class="form-input"
            id="manager-id"
            required
            [(ngModel)]="employeeId"
            name="managerId"
            #managerInput="ngModel"
          >
            <option value="">Select an employee</option>
            @for(manager of empList;track manager.Id){
            <option [value]="manager.Id">{{ manager.Name }}</option>
            }
          </select>
          @if (managerInput.touched && managerInput.invalid) {
          <p class="validation-error">Please select an employee</p>
          }
        </div>
      </form>
    </div>

    <div class="modal-footer">
      <div class="form-actions">
        <button
          type="submit"
          class="submit-btn"
          [disabled]="addtask.invalid && isaddtasktrue()"
          (click)="addnewtask()"
        >
          Create Project
        </button>
        <button type="button" class="cancel-btn" (click)="close()">
          Cancel
        </button>
      </div>
    </div>
  </div>
</div>
